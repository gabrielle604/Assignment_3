---
title: "Benoit_Assignment_3"
author: "Gabrielle"
date: '2022-11-09'
output: 
  html_document:
    code_folding: hide
---

##### Covers lab 4, 5, and 6 and the R markdown formatting discussed in Lecture 12

- why you chose to do the test you did? did you inspect the data and did it meet the assumptions?
- there are multiple answers for all of these... you could do a transformation, but you do not need to

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning = FALSE,results=FALSE)

library(tidyverse)
library(here)
library(ggpubr) # for some graphic applications that extend ggplot2
library(janitor)
# install.packages("lsr")
library(lsr)
library(effsize)
library(dplyr)
# install.packages("qqplotr")
library(qqplotr)
library(ggplot2)
# install.packages("DescTools")
library(DescTools)

```

## Question 1:
In order to determine if the current population in the San Antonio River in Santa Barbara County is different from the historical record, I did a one sample t-test, and set mu to equal 4.2 cm (rather than the default, mu = 0), the value from 1955 document that reported the population mean length of adult tidewater gobies. I did this because I am testing to see if there is a statistical difference between the historical mean length of gobies, and the current mean length of gobies (3.5 cm). The one-sample t-test allows us to compare the mean from sample data to a value, usually testing literature point estimates. This test does assume equal variance. 
We found a statistical difference between the current San Antonio Goby fish mean length, and the historical 1955 Goby population mean length (t(9 df), p = 0.0008873), ‚ç∫ = 0.05.
CI: 3.189284, 3.830716

```{r, message=FALSE}
# San Antonio river gobies in centimeters  
# data input: creating a vector of data
san_ant_gobies <- c(2.7, 3.2, 3.2, 3.3, 3.5, 3.6, 3.6, 3.7, 4.0, 4.3)

summary(san_ant_gobies)

san_ant_gobies_one_t <- t.test(san_ant_gobies, mu=4.2)
san_ant_gobies_one_t
```


## Question 2:
Are the tidewater goby lengths in question 1 normally distributed? Provide a figure with caption **or** critical statistical test and justify your results and conclusion.

For this data, to look at whether the tidewater goby lengths are normally distributed, we're going to look at a qq plot. It should be mostly a straight line, however, due to there being very few observations,  some wobble to the line is expected. 

```{r goby_1, fig.align='center',fig.cap="Figure 1. Quantile-Quantile plot showing the empirically observed quantiles of San Antonio River Gobies (cm) as a function of quantiles expected from a normal distribution with the same mean and variance as the empirical distribution."}
# qqplot for san antonio river gobies
qqplot_san_ant_gobies <- ggplot(data.frame(san_ant_gobies), 
                     aes(sample = san_ant_gobies)) +
                     geom_qq() +
                     labs(title = "San Antonio River Gobies") +
                     theme_minimal()

qqplot_san_ant_gobies
```


## Question 3:
The UC Tobacco Free Campus Initiative wants to know if the UC reserves have more or less cigarette butt load as urban open spaces. 
Use your knowledge of statistics to:
1. justify the appropriate statistical test to use
2. explain the results and conclusion of the test you selected
3. make a figure with caption to best explain the data and results.

The non-parametric, Mann-Whitney U test (called Wilcox test in R) is the appropriate statistical test becuase the data is not normal; it is skewed. The Wilcox test in R is the pairwise comparison analogous to the Tukey HSD by looking at pairwise Wilcox tests that have been adjusted for multiple comparison, a type of continuity correction. Here we have used the easiest correction, Bonferroni, where the p-value from the pairwise test is multiplied by the number of comparisons.

Since non-parametric evaluations are largely based on comparing medians instead of means, it is suggested that you plot the results using box plots instead of means and 95% confidence intervals as done parametrically. 

```{r}
uc_reserves <- data.frame(cig_butts=c(4, 1, 8, 0, 0, 0, 0, 23, 28, 0, 0, 0, 4, 0, 3, 0, 0, 2, 0, 5, 0, 0, 0, 0, 0),location="Reserve")


urban_open <- data.frame(cig_butts=c(33, 9, 9, 7, 2, 38, 9, 20, 0, 39, 18, 41, 25, 164, 37, 60, 55, 45, 14, 3, 69, 60, 13, 1), location="Urban Open Space")

cig_df <- rbind(uc_reserves, urban_open)

qqplot_uc_reserves <- ggplot((uc_reserves), aes(sample = cig_butts)) +
  geom_qq() +
  labs(title = "UC Reserves") +
  theme_minimal()

qqplot_uc_reserves

qqplot_urban_open <- ggplot((urban_open), aes(sample = cig_butts)) +
  geom_qq() +
  labs(title = "Urban Open Space") +
  theme_minimal()

qqplot_urban_open

# showing the skewed data

```

```{r}
pairwise.wilcox.test(cig_df$cig_butts, cig_df$location, p.adjust.method = "bonferroni")

wilcox.test(uc_reserves$cig_butts, urban_open$cig_butts, paired = FALSE)
```
The bonferroni adjustment takes the p value divided by the number of groups (for this, divide by two, due to UC Reserves and Urban Open Space)

Mann Whitney U is an unpaired test of medians, whereas Wilcoxon is paired tests of medians between two groups. Default, paired = FALSE, comparing independent unpaired samples together. 

```{r cig_load_1, fig.align='center',fig.cap="Figure 2. Boxplot showing cigarette butt load for the UC Reserve and for Urban Open Space, the boxes marking quantile 1, the median, quantile 3, and the dots denote the outliers."}
boxplot_cig_load <- ggplot(data = cig_df, aes(x = location, y = cig_butts)) +
  geom_boxplot() +
  theme_minimal() +
  labs(title = "Cigarette Butt Load", x = "Location", y = "Cigarette Butts")

boxplot_cig_load
```





## Question 4:
Is there evidence that this new species of turtles' time between laid egg and hatching is temperature dependent? 

1. justify the appropriate statistical tests to use
2. explain the results and conclusion of the test you selected
3. make a figure with a caption to best explain the data, results, and conclusion


Four groups: 15C, 20C, 25C, 30C

how did you look at the data?
what did you find?
provide a nice figure?

Load in the data:
```{r}
turtles <- read_csv(here("data", "Turtles.csv"))

turtles_scatter <- ggplot(turtles, aes(x = Temperature, y = Days)) +
  geom_point() +
  labs(title = "Relationship between temperature and number of days to turtle egg hatching", x = "Temperature (C)", y = "Days") +
  geom_smooth(formula = y~x, method = lm) +
  theme_minimal()

turtles_scatter

# separate out 15C, 20C, 25C, 30C
turtles_15c <- turtles %>% filter(Temperature == "15")

turtles_20c <- turtles %>% filter(Temperature == "20")

turtles_25c <- turtles %>% filter(Temperature == "25")

turtles_30c <- turtles %>% filter(Temperature == "30")
```

```{r}
# do a qqplot for each

qqplot_15c <- ggplot(turtles_15c, 
                     aes(sample = turtles_15c)) +
                     geom_qq() +
                     labs(title = "Turtles at 15C") +
                     theme_minimal()
qqplot_15c

```


NEXT:
shapiro test for normality
do an anova comparing each
tukey test

```{r}

```

